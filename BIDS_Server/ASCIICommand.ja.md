---
parent: BIDS_Server
---

# BIDS_Server 文字列形式コマンド解説
# BIDS ASCII Commands doc
このファイルは, BIDSの文字列コマンド形式の説明です.  v100に対応しています

## コマンド形式
コマンドの形式は, 次のとおりです.  なお, 二行目に記載の文字列はコマンド例です.
~~~
[Header][Identifier][DataType(Optional)][RequestNumber][Suffix]
TRIP52\n
~~~

### Header
ヘッダは, "TR"という2文字(2バイト)固定です.

### Identifier
識別子は, 1文字(1バイト)で表される, コマンドの役割を示す文字です.  以下の種類があります.

|Identifier|Description|
|---|---|
|R|レバーサー操作要求|
|S|ワンハンドル操作要求|
|P|力行ハンドル操作要求|
|B|制動ハンドル操作要求|
|K|キー操作要求|
|I|運転情報要求|
|V|バージョン情報要求|
|E|エラー通知|

### DataType
データ種別は, 一部コマンドで使用されます.  詳細は, 識別子別要求番号対応にて紹介します.

### RequestNumber
要求情報(番号)は, 識別子ごとに決められた操作に対応する番号です.  詳細は, 識別子別要求番号対応にて紹介します.

### Suffix
接尾辞は, 改行文字が使用されます.  "\n"でも, "\r"でも, "\r\n"でも構いません.  

## 識別子別要求番号対応
### R レバーサー操作要求

|Num|Description|
|---|---|
|-1|レバーサーを"後"位置に投入|
|0|レバーサーを"中"位置に投入|
|1|レバーサーを"前"位置に投入|

### S/B/P ワンハンドル/制動/力行操作要求

|Num|Description|
|---|---|
|n|ハンドルをnに移動する(nには任意の整数が入ります)|

なお, 力行の場合, 負の範囲は抑速に相当します.

### K キー操作要求

|Type|Num|Description|
|---|---|---|
|P|n|車両のn番ボタンのPressイベントを発生させる|
|R|n|車両のn番ボタンのReleaseイベントを発生させる|

なお, 上記表内 `n` に入る数値は, 次の表のとおりです.

|Num|Description|
|---|---|
|0|Horn 1|
|1|Horn 2|
|2|Music Horn|
|3|Const Speed|
|4|ATS_S|
|5|ATS_A1|
|6|ATS_A2|
|7|ATS_B1|
|8|ATS_B2|
|9|ATS_C1|
|10|ATS_C2|
|11|ATS_D|
|12|ATS_E|
|13|ATS_F|
|14|ATS_G|
|15|ATS_H|
|16|ATS_I|
|17|ATS_J|
|18|ATS_K|
|19|ATS_L|

### I 運転情報要求
v202では, 負の範囲を指定することで情報の一括要求を行えますが, とりあえず記載を省略します.

#### C : Spec Data

|Type|Num|Description|
|---|---|---|
|C|0|制動ノッチ段数|
|C|1|力行ノッチ段数|
|C|2|ATS確認位置|
|C|3|B67に相当する位置(常用最大段数)|
|C|4|編成車両数|

#### E : State Data

|Type|Num|Description|
|---|---|---|
|E|0|列車位置(m)|
|E|1|列車速度(km/h)|
|E|2|現在時刻(0時からの経過時間 ms)|
|E|3|BC圧(kPa)|
|E|4|MR圧(kPa)|
|E|5|ER圧(kPa)|
|E|6|BP圧(kPa)|
|E|7|SAP圧(kPa)|
|E|8|電流(A)|
|E|9|(予約領域)電圧(V)|
|E|10|現在時刻("時"部分)|
|E|11|現在時刻("分"部分)|
|E|12|現在時刻("秒"部分)|
|E|13|現在時刻("ミリ秒"部分)|

#### H : Handle Position

|Type|Num|Description|
|---|---|---|
|H|0|制動ハンドル位置|
|H|1|力行ハンドル位置|
|H|2|レバーサーハンドル位置|
|H|3|(予約)定速状態|

#### P : Panel

|Type|Num|Description|
|---|---|---|
|P|n|n番のパネル状態|

#### S : Sound

|Type|Num|Description|
|---|---|---|
|S|n|n番の音再生状態|

#### D : Door

|Type|Num|Description|
|---|---|---|
|D|0|ドア状態|

なお, ドア状態は0で閉扉状態, 1で開扉状態です

### V : バージョン情報要求

|Num|Description|
---|---|
|100|バージョン100準拠を示す|

### E : エラー情報
省略